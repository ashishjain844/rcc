"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const environments_1 = require("../environments");
const data_1 = require("../data");
function validateRequest(req, res, next) {
    const accessToken = req.header('x-access-token');
    const accessStatus = (typeof accessToken === 'string' && accessToken === environments_1.config.SECRET_TOKEN) ||
        (typeof accessToken === 'object' && Array.isArray(accessToken) && accessToken.some(token => token === environments_1.config.SECRET_TOKEN));
    if (!accessStatus)
        return res.status(401).json({ message: data_1.response.INVALID_TOKEN });
    next();
}
exports.validateRequest = validateRequest;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL2hvbWUvYXBwaW52ZW50aXZyaC0wNTgvQXNoaXNoLXdvcmsvcmNjL2FwaS9taWRkbGV3YXJlL3ZhbGlkYXRlLXJlcXVlc3QudHMiLCJzb3VyY2VzIjpbIi9ob21lL2FwcGludmVudGl2cmgtMDU4L0FzaGlzaC13b3JrL3JjYy9hcGkvbWlkZGxld2FyZS92YWxpZGF0ZS1yZXF1ZXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQ0Esa0RBQXlDO0FBQ3pDLGtDQUFtQztBQUVuQyx5QkFBZ0MsR0FBWSxFQUFFLEdBQWEsRUFBRSxJQUFrQjtJQUMzRSxNQUFNLFdBQVcsR0FBRyxHQUFHLENBQUMsTUFBTSxDQUFDLGdCQUFnQixDQUFDLENBQUM7SUFDakQsTUFBTSxZQUFZLEdBQUcsQ0FBQyxPQUFPLFdBQVcsS0FBSyxRQUFRLElBQUksV0FBVyxLQUFLLHFCQUFNLENBQUMsWUFBWSxDQUFDO1FBQ3pGLENBQUMsT0FBTyxXQUFXLEtBQUssUUFBUSxJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLElBQWUsV0FBWSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLEtBQUssS0FBSyxxQkFBTSxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUE7SUFDM0ksSUFBSSxDQUFDLFlBQVk7UUFBRSxPQUFPLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUMsT0FBTyxFQUFFLGVBQVEsQ0FBQyxhQUFhLEVBQUMsQ0FBQyxDQUFDO0lBQ2xGLElBQUksRUFBRSxDQUFDO0FBQ1gsQ0FBQztBQU5ELDBDQU1DIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUmVxdWVzdCwgUmVzcG9uc2UsIE5leHRGdW5jdGlvbiB9IGZyb20gXCJleHByZXNzXCI7XG5pbXBvcnQgeyBjb25maWcgfSBmcm9tIFwiLi4vZW52aXJvbm1lbnRzXCI7XG5pbXBvcnQgeyByZXNwb25zZSB9IGZyb20gXCIuLi9kYXRhXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVJlcXVlc3QocmVxOiBSZXF1ZXN0LCByZXM6IFJlc3BvbnNlLCBuZXh0OiBOZXh0RnVuY3Rpb24pIHtcbiAgICBjb25zdCBhY2Nlc3NUb2tlbiA9IHJlcS5oZWFkZXIoJ3gtYWNjZXNzLXRva2VuJyk7XG4gICAgY29uc3QgYWNjZXNzU3RhdHVzID0gKHR5cGVvZiBhY2Nlc3NUb2tlbiA9PT0gJ3N0cmluZycgJiYgYWNjZXNzVG9rZW4gPT09IGNvbmZpZy5TRUNSRVRfVE9LRU4pIHx8XG4gICAgICAgICh0eXBlb2YgYWNjZXNzVG9rZW4gPT09ICdvYmplY3QnICYmIEFycmF5LmlzQXJyYXkoYWNjZXNzVG9rZW4pICYmICg8c3RyaW5nW10+YWNjZXNzVG9rZW4pLnNvbWUodG9rZW4gPT4gdG9rZW4gPT09IGNvbmZpZy5TRUNSRVRfVE9LRU4pKVxuICAgIGlmICghYWNjZXNzU3RhdHVzKSByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oe21lc3NhZ2U6IHJlc3BvbnNlLklOVkFMSURfVE9LRU59KTtcbiAgICBuZXh0KCk7XG59XG4iXX0=