"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const joi = require("joi");
const db_1 = require("../../db");
const response_1 = require("../../data/response");
const registerDataSchema = joi.object().keys({
    name: joi.string().required(),
    username: joi.string().email().required(),
    password: joi.string().required(),
    dob: joi.date().required()
});
function register(req, res, next) {
    const result = joi.validate(req.body, registerDataSchema);
    if (result.error) {
        console.log(">>", result.error);
        return res.status(400).send({ message: result.error.details[0].message.split('"').join('') });
    }
    db_1.admin.register(result.value).then(function (result) {
        res.status(result.status).send({ message: result.message });
    }).catch(function (error) {
        res.status(500).send({ message: response_1.response.INTERNAL_ERROR });
    });
}
exports.register = register;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL2hvbWUvYXBwaW52ZW50aXZyaC0wNTgvQXNoaXNoLXdvcmsvcmNjL2FwaS9jb250cm9sbGVycy9hZG1pbi9yZWdpc3Rlci50cyIsInNvdXJjZXMiOlsiL2hvbWUvYXBwaW52ZW50aXZyaC0wNTgvQXNoaXNoLXdvcmsvcmNjL2FwaS9jb250cm9sbGVycy9hZG1pbi9yZWdpc3Rlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUNBLDJCQUEyQjtBQUMzQixpQ0FBaUM7QUFDakMsa0RBQStDO0FBRS9DLE1BQU0sa0JBQWtCLEdBQUcsR0FBRyxDQUFDLE1BQU0sRUFBRSxDQUFDLElBQUksQ0FBQztJQUN6QyxJQUFJLEVBQUUsR0FBRyxDQUFDLE1BQU0sRUFBRSxDQUFDLFFBQVEsRUFBRTtJQUM3QixRQUFRLEVBQUUsR0FBRyxDQUFDLE1BQU0sRUFBRSxDQUFDLEtBQUssRUFBRSxDQUFDLFFBQVEsRUFBRTtJQUN6QyxRQUFRLEVBQUUsR0FBRyxDQUFDLE1BQU0sRUFBRSxDQUFDLFFBQVEsRUFBRTtJQUNqQyxHQUFHLEVBQUUsR0FBRyxDQUFDLElBQUksRUFBRSxDQUFDLFFBQVEsRUFBRTtDQUM3QixDQUFDLENBQUM7QUFHSCxrQkFBeUIsR0FBWSxFQUFFLEdBQWEsRUFBRSxJQUFrQjtJQUNwRSxNQUFNLE1BQU0sR0FBRyxHQUFHLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsa0JBQWtCLENBQUMsQ0FBQztJQUMxRCxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUU7UUFDZCxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDaEMsT0FBTyxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFDLE9BQU8sRUFBRSxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsRUFBQyxDQUFDLENBQUM7S0FDL0Y7SUFDRCxVQUFLLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBUyxNQUFNO1FBQzdDLEdBQUcsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFDLE9BQU8sRUFBRSxNQUFNLENBQUMsT0FBTyxFQUFDLENBQUMsQ0FBQztJQUM5RCxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsVUFBUyxLQUFLO1FBQ25CLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUMsT0FBTyxFQUFFLG1CQUFRLENBQUMsY0FBYyxFQUFDLENBQUMsQ0FBQztJQUM3RCxDQUFDLENBQUMsQ0FBQztBQUNQLENBQUM7QUFYRCw0QkFXQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJlcXVlc3QsIFJlc3BvbnNlLCBOZXh0RnVuY3Rpb24gfSBmcm9tIFwiZXhwcmVzc1wiO1xuaW1wb3J0ICogYXMgam9pIGZyb20gJ2pvaSc7XG5pbXBvcnQgeyBhZG1pbiB9IGZyb20gJy4uLy4uL2RiJztcbmltcG9ydCB7IHJlc3BvbnNlIH0gZnJvbSAnLi4vLi4vZGF0YS9yZXNwb25zZSc7XG5cbmNvbnN0IHJlZ2lzdGVyRGF0YVNjaGVtYSA9IGpvaS5vYmplY3QoKS5rZXlzKHtcbiAgICBuYW1lOiBqb2kuc3RyaW5nKCkucmVxdWlyZWQoKSxcbiAgICB1c2VybmFtZTogam9pLnN0cmluZygpLmVtYWlsKCkucmVxdWlyZWQoKSxcbiAgICBwYXNzd29yZDogam9pLnN0cmluZygpLnJlcXVpcmVkKCksXG4gICAgZG9iOiBqb2kuZGF0ZSgpLnJlcXVpcmVkKClcbn0pO1xuXG5cbmV4cG9ydCBmdW5jdGlvbiByZWdpc3RlcihyZXE6IFJlcXVlc3QsIHJlczogUmVzcG9uc2UsIG5leHQ6IE5leHRGdW5jdGlvbikge1xuICAgIGNvbnN0IHJlc3VsdCA9IGpvaS52YWxpZGF0ZShyZXEuYm9keSwgcmVnaXN0ZXJEYXRhU2NoZW1hKTtcbiAgICBpZiAocmVzdWx0LmVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiPj5cIiwgcmVzdWx0LmVycm9yKTtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKHttZXNzYWdlOiByZXN1bHQuZXJyb3IuZGV0YWlsc1swXS5tZXNzYWdlLnNwbGl0KCdcIicpLmpvaW4oJycpfSk7XG4gICAgfVxuICAgIGFkbWluLnJlZ2lzdGVyKHJlc3VsdC52YWx1ZSkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgcmVzLnN0YXR1cyhyZXN1bHQuc3RhdHVzKS5zZW5kKHttZXNzYWdlOiByZXN1bHQubWVzc2FnZX0pO1xuICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHttZXNzYWdlOiByZXNwb25zZS5JTlRFUk5BTF9FUlJPUn0pO1xuICAgIH0pO1xufSJdfQ==