"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const model_1 = require("../model");
const response_1 = require("../../../data/response");
function register(data) {
    return new Promise(function (resolve, reject) {
        model_1.Admin.find({
            username: data.username
        }, { _id: true, statusCode: true }).then(function (result) {
            // unverified user
            if (result.some(admin => admin['statusCode'] === 0)) {
                return resolve({ status: 422, message: response_1.response.ACCOUNT_UNVERIFIED });
            }
            // active user
            if (result.some(admin => admin['statusCode'] === 1)) {
                return resolve({ status: 422, message: response_1.response.REGISTER_PRESENT });
            }
            // blocked user
            if (result.some(admin => admin['statusCode'] === 2)) {
                return resolve({ status: 422, message: response_1.response.ACCOUNT_BLOCKED });
            }
            // archived user
            if (result.some(admin => admin['statusCode'] === 3)) {
                return resolve({ status: 422, message: response_1.response.ACCOUNT_ARCHIVED });
            }
            const admin = new model_1.Admin(data);
            admin.save().then(function () {
                resolve({ status: 200, message: response_1.response.REGISTER_SUCCESS });
            }).catch(reject);
        }).catch(reject);
    });
}
exports.register = register;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL2hvbWUvYXBwaW52ZW50aXZyaC0wNTgvQXNoaXNoLXdvcmsvcmNjL2FwaS9kYi9hZG1pbi9vcGVyYXRpb25zL3JlZ2lzdGVyLnRzIiwic291cmNlcyI6WyIvaG9tZS9hcHBpbnZlbnRpdnJoLTA1OC9Bc2hpc2gtd29yay9yY2MvYXBpL2RiL2FkbWluL29wZXJhdGlvbnMvcmVnaXN0ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxvQ0FBaUM7QUFFakMscURBQWtEO0FBR2xELGtCQUF5QixJQUFTO0lBRTlCLE9BQU8sSUFBSSxPQUFPLENBQUMsVUFBUyxPQUFPLEVBQUUsTUFBTTtRQUN2QyxhQUFLLENBQUMsSUFBSSxDQUFDO1lBQ1AsUUFBUSxFQUFFLElBQUksQ0FBQyxRQUFRO1NBQzFCLEVBQUUsRUFBQyxHQUFHLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxJQUFJLEVBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFTLE1BQXVCO1lBRW5FLGtCQUFrQjtZQUNsQixJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUU7Z0JBQ2pELE9BQU8sT0FBTyxDQUFDLEVBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRSxPQUFPLEVBQUUsbUJBQVEsQ0FBQyxrQkFBa0IsRUFBQyxDQUFDLENBQUM7YUFDdkU7WUFFRCxjQUFjO1lBQ2QsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFO2dCQUNqRCxPQUFPLE9BQU8sQ0FBQyxFQUFDLE1BQU0sRUFBRSxHQUFHLEVBQUUsT0FBTyxFQUFFLG1CQUFRLENBQUMsZ0JBQWdCLEVBQUMsQ0FBQyxDQUFDO2FBQ3JFO1lBRUQsZUFBZTtZQUNmLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRTtnQkFDakQsT0FBTyxPQUFPLENBQUMsRUFBQyxNQUFNLEVBQUUsR0FBRyxFQUFFLE9BQU8sRUFBRSxtQkFBUSxDQUFDLGVBQWUsRUFBQyxDQUFDLENBQUM7YUFDcEU7WUFFRCxnQkFBZ0I7WUFDaEIsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFO2dCQUNqRCxPQUFPLE9BQU8sQ0FBQyxFQUFDLE1BQU0sRUFBRSxHQUFHLEVBQUUsT0FBTyxFQUFFLG1CQUFRLENBQUMsZ0JBQWdCLEVBQUMsQ0FBQyxDQUFDO2FBQ3JFO1lBRUQsTUFBTSxLQUFLLEdBQUcsSUFBSSxhQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDOUIsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksQ0FBQztnQkFDZCxPQUFPLENBQUMsRUFBQyxNQUFNLEVBQUUsR0FBRyxFQUFFLE9BQU8sRUFBRSxtQkFBUSxDQUFDLGdCQUFnQixFQUFDLENBQUMsQ0FBQztZQUMvRCxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUM7UUFFckIsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3JCLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQztBQWxDRCw0QkFrQ0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBZG1pbiB9IGZyb20gJy4uL21vZGVsJztcbmltcG9ydCB7IEFkbWluRG9jdW1lbnQgfSBmcm9tICcuLi9kb2N1bWVudCc7XG5pbXBvcnQgeyByZXNwb25zZSB9IGZyb20gJy4uLy4uLy4uL2RhdGEvcmVzcG9uc2UnO1xuaW1wb3J0IHsgT3BlcmF0aW9uUmVzdWx0IH0gZnJvbSAnLi4vLi4vLi4vdHlwaW5ncyc7XG5cbmV4cG9ydCBmdW5jdGlvbiByZWdpc3RlcihkYXRhOiBhbnkpOiBQcm9taXNlPE9wZXJhdGlvblJlc3VsdD4ge1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBBZG1pbi5maW5kKHtcbiAgICAgICAgICAgIHVzZXJuYW1lOiBkYXRhLnVzZXJuYW1lXG4gICAgICAgIH0sIHtfaWQ6IHRydWUsIHN0YXR1c0NvZGU6IHRydWV9KS50aGVuKGZ1bmN0aW9uKHJlc3VsdDogQWRtaW5Eb2N1bWVudFtdKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIHVudmVyaWZpZWQgdXNlclxuICAgICAgICAgICAgaWYgKHJlc3VsdC5zb21lKGFkbWluID0+IGFkbWluWydzdGF0dXNDb2RlJ10gPT09IDApKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoe3N0YXR1czogNDIyLCBtZXNzYWdlOiByZXNwb25zZS5BQ0NPVU5UX1VOVkVSSUZJRUR9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYWN0aXZlIHVzZXJcbiAgICAgICAgICAgIGlmIChyZXN1bHQuc29tZShhZG1pbiA9PiBhZG1pblsnc3RhdHVzQ29kZSddID09PSAxKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKHtzdGF0dXM6IDQyMiwgbWVzc2FnZTogcmVzcG9uc2UuUkVHSVNURVJfUFJFU0VOVH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBibG9ja2VkIHVzZXJcbiAgICAgICAgICAgIGlmIChyZXN1bHQuc29tZShhZG1pbiA9PiBhZG1pblsnc3RhdHVzQ29kZSddID09PSAyKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKHtzdGF0dXM6IDQyMiwgbWVzc2FnZTogcmVzcG9uc2UuQUNDT1VOVF9CTE9DS0VEfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGFyY2hpdmVkIHVzZXJcbiAgICAgICAgICAgIGlmIChyZXN1bHQuc29tZShhZG1pbiA9PiBhZG1pblsnc3RhdHVzQ29kZSddID09PSAzKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKHtzdGF0dXM6IDQyMiwgbWVzc2FnZTogcmVzcG9uc2UuQUNDT1VOVF9BUkNISVZFRH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBhZG1pbiA9IG5ldyBBZG1pbihkYXRhKTtcbiAgICAgICAgICAgIGFkbWluLnNhdmUoKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoe3N0YXR1czogMjAwLCBtZXNzYWdlOiByZXNwb25zZS5SRUdJU1RFUl9TVUNDRVNTfSk7XG4gICAgICAgICAgICB9KS5jYXRjaChyZWplY3QpO1xuXG4gICAgICAgIH0pLmNhdGNoKHJlamVjdCk7XG4gICAgfSk7XG59XG5cbiJdfQ==